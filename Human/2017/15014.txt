Three-coloring triangle-free graphs on surfaces II. 4-critical graphs in a disk

Let G be a plane graph of girth at least five. We show that if there exists a 3-coloring phi of a cycle C of G that does not extend to a 3-coloring of G, then G has a subgraph H on O(|C|) vertices that also has no 3-coloring extending phi. This is asymptotically best possible and improves a previous bound of Thomassen. In the next paper of the series we will use this result and the attendant theory to prove a generalization to graphs on surfaces with several precolored cycles.
