Largest Weight Common Subtree Embeddings with Distance Penalties

The largest common embeddable subtree problem asks for the largest possible tree embeddable into two input trees and generalizes the classical maximum common subtree problem. Several variants of the problem in labeled and unlabeled rooted trees have been studied, e.g., for the comparison of evolutionary trees. We consider a generalization, where the sought embedding is maximal with regard to a weight function on pairs of labels. We support rooted and unrooted trees with vertex and edge labels as well as distance penalties for skipping vertices. This variant is important for many applications such as the comparison of chemical structures and evolutionary trees. Our algorithm computes the solution from a series of bipartite matching instances, which are solved efficiently by exploiting their structural relation and imbalance. Our analysis shows that our approach improves or matches the running time of the formally best algorithms for several problem variants. Specifically, we obtain a running time of $\mathcal O(|T|\,|T'|Δ)$ for two rooted or unrooted trees $T$ and $T'$, where $Δ=\min\{Δ(T),Δ(T')\}$ with $Δ(X)$ the maximum degree of $X$. If the weights are integral and at most $C$, we obtain a running time of $\mathcal O(|T|\,|T'|\sqrtΔ\log (C\min\{|T|,|T'|\}))$ for rooted trees.
