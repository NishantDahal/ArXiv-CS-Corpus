Computing the $k$-binomial complexity of the Thue--Morse word

Two words are $k$-binomially equivalent whenever they share the same subwords, i.e., subsequences, of length at most $k$ with the same multiplicities. This is a refinement of both abelian equivalence and the Simon congruence. The $k$-binomial complexity of an infinite word $\mathbf{x}$ maps the integer $n$ to the number of classes in the quotient, by this $k$-binomial equivalence relation, of the set of factors of length $n$ occurring in $\mathbf{x}$. This complexity measure has not been investigated very much. In this paper, we characterize the $k$-binomial complexity of the Thue--Morse word. The result is striking, compared to more familiar complexity functions. Although the Thue--Morse word is aperiodic, its $k$-binomial complexity eventually takes only two values. In this paper, we first obtain general results about the number of occurrences of subwords appearing in iterates of the form $Ψ^\ell(w)$ for an arbitrary morphism $Ψ$. We also thoroughly describe the factors of the Thue--Morse word by introducing a relevant new equivalence relation.
