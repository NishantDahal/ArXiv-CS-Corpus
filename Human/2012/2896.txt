The steepest watershed: from graphs to images

The watershed is a powerful tool for segmenting objects whose contours appear as crest lines on a gradient image. The watershed transform associates to a topographic surface a partition into catchment basins, defined as attraction zones of a drop of water falling on the relief and following a line of steepest descent. Unfortunately, catchment basins may overlap and do not form a partition. Moreover, current watershed algorithms, being shortsighted, do not correctly estimate the steepness of the downwards trajectories and overestimate the overlapping zones of catchment basins. An arbitrary division of these zones between adjacent catchment basin results in a poor localization of the contours. We propose an algorithm without myopia, which considers the total length of a trajectory for estimating its steepness. We first consider topographic surfaces defined on node weighted graphs. The graphs are pruned in order to eliminate all downwards trajectories which are not the steepest. An iterative algorithm with simple neighborhood operations performs the pruning and constructs the catchment basins. The algorithm is then adapted to gray tone images. The graph structure itself is encoded as an image thanks to the fixed neighborhood structure of grids. A pair of adaptative erosions and dilations prune the graph and extend the catchment basins. As a result one obtains a precise detection of the catchment basins and a graph of the steepest trajectories. A last iterative algorithm allows to follow selected downwards trajectories in order to detect particular structures such as rivers or thalweg lines of the topographic surface.
