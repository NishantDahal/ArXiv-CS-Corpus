Refined bounds on the number of connected components of sign conditions on a variety

Let $\R$ be a real closed field, $\mathcal{P},\mathcal{Q} \subset \R[X_1,...,X_k]$ finite subsets of polynomials, with the degrees of the polynomials in $\mathcal{P}$ (resp. $\mathcal{Q}$) bounded by $d$ (resp. $d_0$). Let $V \subset \R^k$ be the real algebraic variety defined by the polynomials in $\mathcal{Q}$ and suppose that the real dimension of $V$ is bounded by $k'$. We prove that the number of semi-algebraically connected components of the realizations of all realizable sign conditions of the family $\mathcal{P}$ on $V$ is bounded by $$ \displaylines{\sum_{j=0}^{k'}4^j{s +1\choose j}F_{d,d_0,k,k'}(j),}$$ where $s = \card \; \mathcal{P}$, and $$F_{d,d_0,k,k'}(j)= \textstyle\binom{k+1}{k-k'+j+1} \;(2d_0)^{k-k'}d^j\; \max{2d_0,d}^{k'-j} +2(k-j+1) .$$
  In case $2 d_0 \leq d$, the above bound can be written simply as $$ \displaylines{\sum_{j = 0}^{k'} {s+1 \choose j}d^{k'} d_0^{k-k'} O(1)^{k} = (sd)^{k'} d_0^{k-k'} O(1)^k} $$ (in this form the bound was suggested by J. Matousek. Our result improves in certain cases (when $d_0 \ll d$) the best known bound of $$ \sum_{1 \leq j \leq k'}
  \binom{s}{j} 4^{j} d(2d-1)^{k-1} $$ on the same number proved earlier in the case $d=d_0$.
  The distinction between the bound $d_0$ on the degrees of the polynomials defining the variety $V$ and the bound $d$ on the degrees of the polynomials in $\mathcal{P}$ that appears in the new bound is motivated by several applications in discrete geometry.
