Sampling BSSRDFs with non-perpendicular incidence

Sub-surface scattering is key to our perception of translucent materials. Models based on diffusion theory are used to render such materials in a realistic manner by evaluating an approximation of the material BSSRDF at any two points of the surface. Under the assumption of perpendicular incidence, this BSSRDF approximation can be tabulated over 2 dimensions to provide fast evaluation and importance sampling. However, accounting for non-perpendicular incidence with the same approach would require to tabulate over 4 dimensions, making the model too large for practical applications. In this report, we present a method to efficiently evaluate and importance sample the multi-scattering component of diffusion based BSSRDFs for non-perpendicular incidence. Our approach is based on tabulating a compressed angular model of Photon Beam Diffusion. We explain how to generate, evaluate and sample our model. We show that 1 MiB is enough to store a model of the multi-scattering BSSRDF that is within $0.5\%$ relative error of Photon Beam Diffusion. Finally, we present a method to use our model in a Monte Carlo particle tracer and show results of our implementation in PBRT.
