Variational inequality approach to enforce the non-negative constraint for advection-diffusion equations

Predictive simulations are crucial for the success of many subsurface applications, and it is highly desirable to obtain accurate non-negative solutions for transport equations in these numerical simulations. In this paper, we propose a computational framework based on the variational inequality (VI) which can also be used to enforce important mathematical properties (e.g., maximum principles) and physical constraints (e.g., the non-negative constraint). We demonstrate that this framework is not only applicable to diffusion equations but also to non-symmetric advection-diffusion equations. An attractive feature of the proposed framework is that it works with with any weak formulation for the advection-diffusion equations, including single-field formulations, which are computationally attractive. A particular emphasis is placed on the parallel and algorithmic performance of the VI approach across large-scale and heterogeneous problems. It is also shown that QP and VI are equivalent under certain conditions. State-of-the-art QP and VI solvers available from the PETSc library are used on a variety of steady-state 2D and 3D benchmarks, and a comparative study on the scalability between the QP and VI solvers is presented. We then extend the proposed framework to transient problems by simulating the miscible displacement of fluids in a heterogeneous porous medium and illustrate the importance of enforcing maximum principles for these types of coupled problems. Our numerical experiments indicate that VIs are indeed a viable approach for enforcing the maximum principles and the non-negative constraint in a large-scale computing environment. Also provided are Firedrake project files as well as a discussion on the computer implementation to help facilitate readers in understanding the proposed framework.
