A general purpose algorithm for counting simple cycles and simple paths of any length

We describe a general purpose algorithm for counting simple cycles and simple paths of any length $\ell$ on a (weighted di)graph on $N$ vertices and $M$ edges, achieving a time complexity of $O\left(N+M+\big(\ell^ω+\ellΔ\big) |S_\ell|\right)$. In this expression, $|S_\ell|$ is the number of (weakly) connected induced subgraphs of $G$ on at most $\ell$ vertices, $Δ$ is the maximum degree of any vertex and $ω$ is the exponent of matrix multiplication. We compare the algorithm complexity both theoretically and experimentally with most of the existing algorithms for the same task. These comparisons show that the algorithm described here is the best general purpose algorithm for the class of graphs where $(\ell^{ω-1}Δ^{-1}+1) |S_\ell|\leq |\text{Cycle}_\ell|$, with $|\text{Cycle}_\ell|$ the total number of simple cycles of length at most $\ell$, including backtracks and self-loops. On Erdős-Rényi random graphs, we find empirically that this happens when the edge probability is larger than circa $4/N$. In addition, we show that some real-world networks also belong to this class. Finally, the algorithm permits the enumeration of simple cycles and simple paths on networks where vertices are labeled from an alphabet on $n$ letters with a time complexity of $O\left(N+M+\big(n^\ell\ell^ω+\ellΔ\big) |S_\ell|\right)$. A Matlab implementation of the algorithm proposed here is available for download.
